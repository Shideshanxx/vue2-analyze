{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val === 'function'\r\n}\r\n\r\nexport function isObject(val) {\r\n    return typeof val === 'object' && val !== null\r\n}","import { isObject } from \"../utils\";\r\n\r\nclass Observer {\r\n    // 通过new命令生成class实例时，会自动调用constructor()，即会执行this.walk(data)方法\r\n    constructor(value) { // 对对象中的所有属性进行劫持\r\n        this.walk(value)\r\n    }\r\n    walk(data) {\r\n        Object.keys(data).forEach(key => {\r\n            // 对data中的每个属性进行响应式处理\r\n            defineReactive(data, key, data[key]);\r\n        })\r\n    }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n    observe(value)  // 【关键】递归，给data中所有层级的所有属性添加getter、setter\r\n    // 如果Vue数据嵌套层级过深 >> 性能会受影响【******************************】\r\n\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            return value\r\n        },\r\n        set(newVal) {\r\n            // 对新数据进行观察\r\n            observe(newVal)\r\n            value = newVal\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data) {\r\n  // 如果是对象才观测；第一次调用observe(vm.$options._data)时，_data一定是个对象，官方要求的写法（data函数返回一个对象）\r\n  if (!isObject(data)) {\r\n    return;\r\n  }\r\n  // 返回经过响应式处理之后的data\r\n  return new Observer(data);\r\n}\r\n","/**\r\n * 数据初始化：initProps、initMethod、initData、initComputed、initWatch\r\n */\r\n\r\nimport { observe } from \"./observer/index\";\r\nimport { isFunction } from \"./utils\";\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options;\r\n  if (opts.props) {\r\n    initProps(vm);\r\n  }\r\n  if (opts.methods) {\r\n    initMethod(vm);\r\n  }\r\n  if (opts.data) {\r\n    // 初始化data\r\n    initData(vm);\r\n  }\r\n  if (opts.computed) {\r\n    initComputed(vm);\r\n  }\r\n  if (opts.watch) {\r\n    initWatch(vm);\r\n  }\r\n\r\n  function initProps() {}\r\n  function initMethod() {}\r\n  function initData(vm) {\r\n    let data = vm.$options.data;\r\n    // 往实例上添加一个属性 _data，即传入的data\r\n    // vue组件data推荐使用函数 防止数据在组件之间共享\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n\r\n    // 对数据进行观测 -- 数据响应式\r\n    observe(data);\r\n  }\r\n  function initComputed() {}\r\n  function initWatch() {}\r\n}\r\n","\r\n/**\r\n * initMixin\r\n * 表示在vue的基础上做一次混合操作\r\n */\r\nimport { initState } from './state'\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function(options) {\r\n        // this指向实例\r\n        const vm = this\r\n        vm.$options = options  // 后面会对options进行扩展\r\n\r\n        // 初始化状态，包括initProps、initMethod、initData、initComputed、initWatch等\r\n        initState(vm)\r\n    }\r\n}","import { initMixin } from \"./init\"\r\n\r\nfunction Vue(options) {\r\n    // new Vue创建实例时会调用_init()方法\r\n    this._init(options)\r\n}\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["isFunction","val","isObject","Observer","value","walk","data","Object","keys","forEach","key","defineReactive","observe","defineProperty","get","set","newVal","initState","vm","opts","$options","props","methods","initData","computed","watch","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAO,SAASA,UAAT,CAAoBC,GAApB,EAAyB;EAC5B,SAAO,OAAOA,GAAP,KAAe,UAAtB;EACH;EAEM,SAASC,QAAT,CAAkBD,GAAlB,EAAuB;EAC1B,SAAO,QAAOA,GAAP,MAAe,QAAf,IAA2BA,GAAG,KAAK,IAA1C;EACH;;MCJKE;EACF;EACA,oBAAYC,KAAZ,EAAmB;EAAA;;EAAE;EACjB,SAAKC,IAAL,CAAUD,KAAV;EACH;;;;aACD,cAAKE,IAAL,EAAW;EACPC,MAAAA,MAAM,CAACC,IAAP,CAAYF,IAAZ,EAAkBG,OAAlB,CAA0B,UAAAC,GAAG,EAAI;EAC7B;EACAC,QAAAA,cAAc,CAACL,IAAD,EAAOI,GAAP,EAAYJ,IAAI,CAACI,GAAD,CAAhB,CAAd;EACH,OAHD;EAIH;;;;;;EAGL,SAASC,cAAT,CAAwBL,IAAxB,EAA8BI,GAA9B,EAAmCN,KAAnC,EAA0C;EACtCQ,EAAAA,OAAO,CAACR,KAAD,CAAP,CADsC;EAEtC;;EAEAG,EAAAA,MAAM,CAACM,cAAP,CAAsBP,IAAtB,EAA4BI,GAA5B,EAAiC;EAC7BI,IAAAA,GAD6B,iBACvB;EACF,aAAOV,KAAP;EACH,KAH4B;EAI7BW,IAAAA,GAJ6B,eAIzBC,MAJyB,EAIjB;EACR;EACAJ,MAAAA,OAAO,CAACI,MAAD,CAAP;EACAZ,MAAAA,KAAK,GAAGY,MAAR;EACH;EAR4B,GAAjC;EAUH;;EAEM,SAASJ,OAAT,CAAiBN,IAAjB,EAAuB;EAC5B;EACA,MAAI,CAACJ,QAAQ,CAACI,IAAD,CAAb,EAAqB;EACnB;EACD,GAJ2B;;;EAM5B,SAAO,IAAIH,QAAJ,CAAaG,IAAb,CAAP;EACD;;ECtCD;EACA;EACA;EAKO,SAASW,SAAT,CAAmBC,EAAnB,EAAuB;EAC5B,MAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB;;EACA,MAAID,IAAI,CAACE,KAAT,EAAgB;;EAGhB,MAAIF,IAAI,CAACG,OAAT,EAAkB;;EAGlB,MAAIH,IAAI,CAACb,IAAT,EAAe;EACb;EACAiB,IAAAA,QAAQ,CAACL,EAAD,CAAR;EACD;;EACD,MAAIC,IAAI,CAACK,QAAT,EAAmB;;EAGnB,MAAIL,IAAI,CAACM,KAAT,EAAgB;;EAMhB,WAASF,QAAT,CAAkBL,EAAlB,EAAsB;EACpB,QAAIZ,IAAI,GAAGY,EAAE,CAACE,QAAH,CAAYd,IAAvB,CADoB;EAGpB;;EACAA,IAAAA,IAAI,GAAGY,EAAE,CAACQ,KAAH,GAAW1B,UAAU,CAACM,IAAD,CAAV,GAAmBA,IAAI,CAACqB,IAAL,CAAUT,EAAV,CAAnB,GAAmCZ,IAArD,CAJoB;;EAOpBM,IAAAA,OAAO,CAACN,IAAD,CAAP;EACD;EAGF;;ECtCD;EACA;EACA;EACA;EAEO,SAASsB,SAAT,CAAmBC,GAAnB,EAAwB;EAC3BA,EAAAA,GAAG,CAACC,SAAJ,CAAcC,KAAd,GAAsB,UAASC,OAAT,EAAkB;EACpC;EACA,QAAMd,EAAE,GAAG,IAAX;EACAA,IAAAA,EAAE,CAACE,QAAH,GAAcY,OAAd,CAHoC;EAKpC;;EACAf,IAAAA,SAAS,CAACC,EAAD,CAAT;EACH,GAPD;EAQH;;ECbD,SAASW,GAAT,CAAaG,OAAb,EAAsB;EAClB;EACA,OAAKD,KAAL,CAAWC,OAAX;EACH;;EACDJ,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}